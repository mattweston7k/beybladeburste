<!DOCTYPE html>
<title>Painted disks</title>
<meta name="format-detection" content="telephone=no">
<script src='/include/common.js'></script>
<style>
article {
    padding:0 1em;
}
table {
    perspective:200em;
    margin:auto;
    --width:4.5rem;width:var(--width);
    --height:2.5rem;height:calc(var(--height)*12);
    --extend:calc(var(--width)*var(--rows)/2/3);
    perspective-origin:50% 150%;
    -webkit-perspective-origin:50% 150%;
    cursor:grab;
}
tbody {
    --spin:calc(360deg/var(--rows)*(var(--checked) - 1));
    transform:translateZ(calc(-1*var(--extend))) rotateY(calc(-1*var(--spin)));
    transform-style:preserve-3d;
    position:relative;
    will-change:transform;transition:1s;
}
tr {
    --position:calc(360deg/var(--rows)*(var(--index) - 1));
    transform:rotateY(var(--position)) translateZ(var(--extend));
    position:absolute;
    width:100%;
    will-change:transform;transition:1s;
    user-select:none;-webkit-user-select:none;
}
td {
    display:flex;justify-content:center;align-items:center;
    height:var(--height);
    margin:0.2em 0;
    border:0.1em solid var(--c);
    color:var(--c);
    background:gray;
    position:relative;
    z-index:0;
    font-size:1.3em;white-space:nowrap;
}
td:empty {
    border-color:silver;
    color:lightgray;
}
td.got {
    background:var(--c);
    color:white;
}
td:nth-child(1) {--c:sienna;}
td:nth-child(2) {--c:gold;}
td:nth-child(3) {--c:forestgreen;}
td:nth-child(4) {--c:dodgerblue;}
td:nth-child(5) {--c:slateblue;}
td:nth-child(6) {--c:darkorchid;}
td:nth-child(7) {--c:crimson;}
td:nth-child(8) {--c:black;}

td::before {
    content:attr(title);
    position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
    font-size:2rem;font-style:italic;
    z-index:-1;
}
dl::before {
    content:'åœ–ä¾‹\A';
    white-space:pre;
}
dd,dt {
    display:inline;
}
dd {
    margin-left:1em;
}
</style>

<main>
    <article>
        <dl>
            <dt>ğŸ°<dd>ã‚³ãƒ­ã‚³ãƒ­é›œèªŒæŠ½é¸ï¼ˆ100 / 321 / 1000 åï¼‰<br>
            <dt>ğŸ¥‡<dd>G1 å¤§æœƒç¬¬ä¸€åè³å“<br>
            <dt>ğŸ¥‰<dd>G1 å¤§æœƒç¬¬ä¸‰åè³å“<br>
            <dt>ğŸ¥ˆ<dd>G4 å¤§æœƒç¬¬äºŒåè³å“<br>
            <dt>ğŸ«<dd>ã¿ã‚“ãªã®ãã˜çåˆ¸è³<br>
            <dt>ğŸˆ‚ï¸<dd>ã‚³ãƒ­ã‚³ãƒ­é›œèªŒå…¨å“¡ service æ‡‰å‹Ÿå“<br>
            <dt>ğŸ’»<dd>ã‚³ãƒ­ã‚³ãƒ­ç¶²åº—å•†å“<br>
            <dt>ğŸ›’<dd>B- å•†å“<br>
            <dt>ğŸ›<dd>BBG-/BA- å•†å“<br>
            <dt>ğŸ®<dd>éŠæˆ²è»Ÿä»¶åŒç¶‘å“<br>
            <dt>ğŸ<dd>è³¼ç‰©æ»¿é¡è´ˆå“<br>
        </dl>
    </article>
    <table>
        <tbody style="--checked:1"></tbody>
    </table>
</main>
<script>
    const disks = ['00', '0', '1', '1â€²', '2', '3', '4', '5', '6', '7', '8', '8â€²', '10', '11', '12', '13'];
    /*Br   Go/Y    G    B       PB   P     R      Bl*/
    [[0, 'ğŸ›', 0, 'ğŸ°ğŸ›', 0, 0, 'ğŸ°ğŸ›', 'ğŸ’»'], /*00*/
        [0, 'ğŸ›ğŸ¥ˆ', 0, 0, 0, 'ğŸˆ‚ï¸', 'ğŸ°ğŸ’»', 'ğŸ°ğŸ’»'], /*0*/
        [0, 'ğŸ°', 0, 0, 0, 0, 0, 0], /*1*/
        [0, 0, 0, 0, 0, 0, 'ğŸ›', 0], /*1'*/
        [0, 'ğŸ¥ˆ', 0, 'ğŸ’»', 0, 0, 0, 0], /*2*/
        [0, 0, 0, 'ğŸ®', 0, 0, 'ğŸ›’', 0], /*3*/
        [0, 0, 0, 'ğŸ’»', 0, 0, 'ğŸ›’', 'ğŸ¥ˆğŸ›ğŸ’»'], /*4*/
        [0, 'ğŸ', 0, 0, 0, 0, 0, 0], /*5*/
        ['ğŸ¥‰', 'ğŸ¥‡', 0, 'ğŸ°', 0, 'ğŸ’»', 'ğŸ°', 0], /*6*/
        [0, 'ğŸ›', 'ğŸ›’', 0, 0, 0, 'ğŸ°ğŸ', 'ğŸˆ‚ï¸'], /*7*/
        [0, 0, 0, 'ğŸ«ğŸˆ‚ï¸', 0, 'ğŸ°', 'ğŸ«', 0], /*8*/
        [0, 'ğŸ°', 0, 0, 0, 0, 0, 'ğŸ’»'], /*8'*/
        [0, 'ğŸ°ğŸˆ‚ï¸', 'ğŸ›', 'ğŸ°', 0, 0, 'ğŸˆ‚ï¸', 0], /*10*/
        ['ğŸ¥‰', 'ğŸ¥‡', 0, 'ğŸ°ğŸ’»', 0, 0, 'ğŸ›’', 0], /*11*/
        [0, 0, 0, 'ğŸ›’', 'ğŸ’»', 0, 0, 0], /*12*/
        [0, 'ğŸ°', 0, 0, 0, 0, 0, 0]  /*13*/
    ].forEach((tr, i) => Q('tbody').insertAdjacentHTML('beforeend', `<tr>${tr.map(td => `<td title=${disks[i]}>${td || ''}</td>`).join('')}</tr>`));

    Q('tr', (tr, i) => tr.style.setProperty('--index', i + 1));
    const table = Q('table');
    const rows = table.querySelectorAll('tr').length;
    table.style.setProperty('--rows', rows);

    let stored = JSON.parse(localStorage.getItem('disk') || null) || [];
    stored.forEach(coor => {
        const [r, d] = coor.split(',').map(n => parseInt(n));
        Q(`tr:nth-child(${r + 1}) td:nth-child(${d + 1})`).classList.add('got');
    });
    Q('td', td => td.onclick = () => {
        if (!td.innerText) return;
        const coor = [...td.parentElement.parentElement.children].indexOf(td.parentElement) + ',' + [...td.parentElement.children].indexOf(td);
        stored = td.classList.contains('got') ? stored.filter(c => c != coor) : [...stored, coor];
        td.classList.toggle('got');
        localStorage.setItem('disk', JSON.stringify(stored));
    });

    const spin = n => {
        const cylinder = Q('tbody');
        Q('tr', tr => tr.removeAttribute('class'));
        const k = parseInt(getComputedStyle(cylinder).getPropertyValue('--checked')) + n;
        cylinder.style.setProperty('--checked', k);
    };
    spin(0);

    let [start, end] = [0, 0];

    table.onpointerdown = ev => start = ev.clientX || ev.touches[0].clientX;
    document.onpointerup = document.ontouchend = () => start = 0;
    table.onpointermove = table.ontouchmove = ev => {
        if (!start) return;
        end = ev.clientX || ev.touches[0].clientX;
        const diff = -parseInt((end - start) / 50);
        if (Math.abs(diff) >= 1) {
            spin(diff);
            start = end;
        }
    };
</script>